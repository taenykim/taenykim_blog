---
title: ğŸ”® ì†Œë§ˆë²• í”„ë¡œì íŠ¸ -6 (jjal)
date: 2020-03-11 12:03:04
category: project
draft: false
---

ì´ë¯¸ì§€ë¥¼ **ì—…ë¡œë“œ**í•˜ê³  **ìˆ˜ì •**í•˜ê³  **ë‹¤ìš´ë¡œë“œ**í•˜ëŠ” ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ë³´ê³  ì‹¶ì–´ì„œ

**ì§¤ë°©ìƒì„±ê¸°**ë¥¼ í•œë²ˆ ë§Œë“¤ì–´ë³´ì•˜ë‹¤.

<hr/>

```toc
exclude: Table of Contents
from-heading: 1
to-heading: 5
```

# \#. Project Map

- :apple: <a href="https://small-magic-project.now.sh/" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸</a>

- :apple: <a href="https://small-magic-project.now.sh/jjal" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸/jjal</a>

* :fire: <a href="https://github.com/taenykim/small-magic-project" target="_blank">í”„ë¡œì íŠ¸ ê¹ƒí—ˆë¸Œì†ŒìŠ¤</a>

<br/>

<details>
<summary>ì œì‘ë…¸íŠ¸ í•œëˆˆì—ë³´ê¸°[ì ‘ê¸°/í¼ì¹˜ê¸°]</summary>
<div markdown="1">

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 1 (container)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B81/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 2 (calculator)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B82/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 3 (graph)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B83/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 4 (crawling)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B84/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 5 (today)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B85/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 6 (jjal)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B86/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 7 (avengers)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B87/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 8 (maskmap)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B88/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 9 (loading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B89/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 10 (lazyloading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B810/)
  </div>
  </details>

# 1. ë ˆì´ì•„ì›ƒ

## 1-1. ë©”ì¸í™”ë©´

![](./images/jjal1.png)

> 1. ì–´í”Œë¦¬ì¼€ì´ì…˜ ì„¤ëª…

> 2. ì´ë¯¸ì§€ ì—…ë¡œë“œ ë²„íŠ¼ê³¼ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼

> 3. ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì°½ (canvas ì´ìš©)

> 4. ì´ë¯¸ì§€ì— ì‚½ì…í•  í…ìŠ¤íŠ¸ ì°½ (input ì´ìš©)

> 5. í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì ˆ ì…€ë ‰íŠ¸ë°•ìŠ¤ (select ì´ìš©)

## 1-2. ì´ë¯¸ì§€ ì—…ë¡œë“œ í™”ë©´

![](./images/jjal2.png)

> ì¹˜ëª…ì ..

## 1-3. ìƒì„±ëœ ì´ë¯¸ì§€

![](./images/jjalbang.png)

> "Hello world!"

# 2. ìƒíƒœê´€ë¦¬

```jsx
const data = useSelector(state => state.jjal)

const [text, setText] = useState(data.text || 'welcome to my page')
const [imageOn, setImageOn] = useState(data.imageOn || '')
const [imageOnWidth, setImageOnWidth] = useState(data.imageOnWidth || '')
const [imageOnHeight, setImageOnHeight] = useState(data.imageOnHeight || '')
const [downloadHref, setDownloadHref] = useState(data.downloadHref || '')
const [textFontSize, setTextFontSize] = useState('20')
```

## 2-1. ë¦¬ì•¡íŠ¸ state

**ë¦¬ì•¡íŠ¸ hooks**ë¥¼ ì´ìš©í•´ì„œ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œì˜ ìƒíƒœê´€ë¦¬ë¥¼ í•˜ì˜€ë‹¤.

ìƒíƒœë³€ìˆ˜ëŠ”

> 1. `text` : ì´ë¯¸ì§€ì— ì‚½ì…ë  í…ìŠ¤íŠ¸

> 2. `imageOn` : ì—…ë¡œë“œëœ ì´ë¯¸ì§€

> 3. `imageOnWidth` : ì—…ë¡œë“œëœ ì´ë¯¸ì§€ width

> 4. `imageOnHeight` : ì—…ë¡œë“œëœ ì´ë¯¸ì§€ height

> 5. `downloadHref` : ë‹¤ìš´ë¡œë“œë§í¬

> 6. `textFontSize` : ì´ë¯¸ì§€ì— ì‚½ì…ë  í…ìŠ¤íŠ¸ í¬ê¸°

## 2-2. ë¦¬ë•ìŠ¤ store

**ë¦¬ë•ìŠ¤ hooks**ë¥¼ ì´ìš©í–ˆë‹¤.

contentsMenuBarì—ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `useDispatch`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ 

`useSelector`ë¡œ ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ë‹¤.

# 3. ì´ë¯¸ì§€ ì—…ë¡œë“œ

## 3-1. View

```jsx
<label htmlFor="imageLoader">ì´ë¯¸ì§€ ì—…ë¡œë“œ</label>
<input type="file" id="imageLoader" name="imageLoader" hidden onChange={handleImage} />
```

file íƒ€ì…ì˜ input íƒœê·¸ë¥¼ hidden ìœ¼ë¡œ ê°€ë¦¬ê³  labelì— ì´ë¯¸ì§€ ì—…ë¡œë“œë¼ëŠ” ê¸€ìì™€ cssë¥¼ ë„£ì–´ì£¼ì—ˆë‹¤.

## 3-2. :apple: FileReader()

```js
const handleImage = e => {
  var reader = new FileReader()
  reader.onload = event => {
    // :star: readerê°€ loadë˜ë©´ ì‹¤í–‰
  }
  reader.readAsDataURL(e.target.files[0])
}
```

íŒŒì¼ì„ ì½ì„ ë•Œ, `FileReader` ê°ì²´ë¥¼ ì´ìš©í–ˆë‹¤.

FileReader ê°ì²´ì˜ `readAsDataURL()` ë©”ì†Œë“œë¥¼ ì´ìš©í•´ íŒŒì¼ì„ ì½ì€ í›„, í•´ë‹¹ íŒŒì¼ì˜ ë°ì´í„° URIë¥¼ result ì†ì„±ì— ì €ì¥í•˜ì˜€ë‹¤.

ê·¸ë¦¬ê³  FileReader ê°ì²´ëŠ” ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡í•  ìˆ˜ ìˆëŠ”ë°,

> event : load(ì½ê¸° ì™„ë£Œ), progress(ì½ëŠ” ì¤‘), error(ì—ëŸ¬)

`onload` ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ë¡œ íŒŒì¼ì´ ì½ê¸° ì™„ë£Œë˜ë©´ ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•˜ì˜€ë‹¤.

> FileReaderì˜ ë¹„ë™ê¸° ë©”ì»¤ë‹ˆì¦˜ì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.

## 3-3. :apple: Image()

```js
// ìœ„ì˜ ì£¼ì„ë¶€ë¶„

reader.onload = event => {
  var img = new Image()
  img.onload = () => {
    // :star: imgê°€ loadë˜ë©´ ì‹¤í–‰
  }
  img.src = event.target.result
}
```

FileReader ë¡œë“œê°€ ì™„ë£Œëœ í›„, íŒŒì¼ì´ uri í˜•íƒœë¡œ ë“¤ì–´ìˆëŠ” result ì†ì„±ì„ `Image` ê°ì²´ ì†ì„± srcì— ë„£ì–´ì£¼ì—ˆë‹¤.

ê·¸ë¦¬ê³  ë§ˆì°¬ê°€ì§€ë¡œ `onload` ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ë¡œ ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•˜ì˜€ë‹¤.

> ë§ˆì°¬ê°€ì§€ë¡œ ë¹„ë™ê¸° ë§¤ì»¤ë‹ˆì¦˜

## 3-4. ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•

```js
// ìœ„ì˜ ì£¼ì„ë¶€ë¶„

img.onload = () => {
  let max_size = 1280,
    width = img.width,
    height = img.height

  if (width > height) {
    if (width > max_size) {
      height *= max_size / width
      width = max_size
    }
  } else {
    if (height > max_size) {
      width *= max_size / height
      height = max_size
    }
  }
  canvas.width = width
  canvas.height = height
  ctx.drawImage(img, 0, 0, width, height)
  setImageOnWidth(width)
  setImageOnHeight(height)
}
```

ì´ë¯¸ì§€ì˜ onload ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ì—ëŠ” ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§• í•¨ìˆ˜ì™€, canvas ì— í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ê·¸ë¦¬ê³  í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” ì½”ë“œë¥¼ ë„£ì–´ì£¼ì—ˆë‹¤.

ë¦¬ì‚¬ì´ì§•ì€ ë¨¼ì € `max_size`ë¥¼ ë‘ê³ , í•´ë‹¹ ì´ë¯¸ì§€ì˜ width í˜¹ì€ heightê°€ `max_size`ë¥¼ ì´ˆê³¼í•˜ë©´ ì´ˆê³¼í•œ width, heightë¥¼ `max_size`ë¡œ ë§ì¶”ê³  ë‚˜ë¨¸ì§€ width, heightë¥¼ ë¹„ìœ¨ì— ë§ê²Œ ì¡°ì •í•˜ëŠ” ì‹ìœ¼ë¡œ í•˜ì˜€ë‹¤.

> width : height = x : max_size (heightê°€ ì´ˆê³¼í•œê²½ìš°)

# 4. ì´ë¯¸ì§€ì— í…ìŠ¤íŠ¸ ì‚½ì…

## 4-1. í…ìŠ¤íŠ¸ ì…ë ¥ì°½

```jsx
<input
  type="file"
  id="imageLoader"
  name="imageLoader"
  hidden
  onChange={e => {
    // :star:
    setText(e.target.value)
  }}
/>
```

## 4-2. í…ìŠ¤íŠ¸ í¬ê¸° ë³€ê²½ì°½

```jsx
<div style={{ display: 'flex', alignItems: 'center' }}>
  <label
    style={{
      marginRight: '10px',
      fontFamily: 'escore7',
      fontSize: '12px',
      color: '#555',
    }}
    htmlFor="textFontSize"
  >
    ê¸€ì í¬ê¸°
  </label>

  <select
    id="textFontSize"
    onChange={e => {
      // :star:
      setTextFontSize(e.target.value)
    }}
  >
    <option value="20">20</option>
    <option value="28">28</option>
    <option value="36">36</option>
    <option value="44">44</option>
  </select>
</div>
```

í…ìŠ¤íŠ¸ ì…ë ¥ì°½, í…ìŠ¤íŠ¸ í¬ê¸° ë³€ê²½ì°½ ëª¨ë‘ change ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ ì½œë°±í•¨ìˆ˜ë¥¼ ë”°ë¡œ ì„ ì–¸í•˜ì§€ ì•Šê³  ì†ì„±ê°’ ë‚´ë¶€ì—ì„œ ë°”ë¡œ ì‹¤í–‰í•˜ê²Œë” í•˜ì˜€ë‹¤.

# 5. real-time Canvas

## 5-1. :apple: useEffect

```jsx
useEffect(() => {
  var canvas = document.getElementById('imageCanvas')
  const ctx = canvas.getContext('2d')
  ctx.textAlign = 'center'
  ctx.textBaseline = 'middle'
  ctx.font = `${textFontSize}px Gulim`
  ctx.clearRect(0, 0, canvas.width, canvas.height)
  if (imageOn) {
    ctx.drawImage(imageOn, 0, 0, imageOnWidth, imageOnHeight)
  } else {
    ctx.fillStyle = 'dodgerblue'
    ctx.fillRect(0, 0, canvas.width, canvas.height)
  }
  ctx.lineWidth = 5
  ctx.strokeStyle = `black`
  ctx.strokeText(text, canvas.width / 2, canvas.height - 40)
  ctx.fillStyle = `white`
  ctx.fillText(text, canvas.width / 2, canvas.height - 40)
})
```

ì•ì„œ ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ì˜ ê°’ê³¼ ìŠ¤íƒ€ì¼ì„ canvasì— ê·¸ë¦¬ëŠ” ì—­í• ë¡œ `useEffect` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

## 5-2. :apple: real-time Canvas

ì²˜ìŒ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ, í…ìŠ¤íŠ¸ê°€ ê²¹ì¹˜ëŠ” í˜„ìƒì´ ì¼ì–´ë‚¬ì—ˆë‹¤.

> helloë¥¼ ì¹˜ë©´ canvas ìœ„ì— h ê°€ ê·¸ë ¤ì§€ê³ , ë‹¤ìŒ he ê°€ ë‹¤ì‹œ ê·¸ë ¤ì§€ê³ , hel ... ì´ëŸ°ì‹ìœ¼ë¡œ ìŒ“ì—¬ë§Œ ê°”ë‹¤.

ê·¸ë˜ì„œ `clearRect()` ë©”ì†Œë“œë¥¼ í†µí•´ canvasë¥¼ ë‹¤ì‹œ ë¦¬ì…‹ì‹œí‚¤ê³ 

imageê°€ ë“±ë¡ëœ ìƒíƒœë©´ ë‹¤ì‹œ imageë¥¼ ê·¸ë¦¬ê³ 

imageê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ì˜ ë°°ê²½ì„ ìœ ì§€í•˜ë„ë¡ ì„¤ì •í•´ì£¼ì—ˆë‹¤.

ê·¸ë¦¬ê³  í…ìŠ¤íŠ¸ ë˜í•œ ê²¹ì¹˜ì§€ ì•Šê²Œ ìƒˆë¡œìš´ ë°°ê²½ì— í˜„ì¬ `text` stateê°’ì„ ê·¸ë¦¬ë„ë¡ ì„¤ì •í•´ì£¼ì—ˆë”ë‹ˆ ê²¹ì¹¨í˜„ìƒì„ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.

# 6. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ

## 6-1. :apple: toDataURL()

```jsx
useEffect(() => {
  const href = canvas.toDataURL()
  setDownloadHref(href)
})
```

ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œëŠ” canvasì˜ `toDataURL()` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í–ˆë‹¤.

canvasë¥¼ ê·¸ë¦´ ë•Œë§ˆë‹¤ setDownloadHref() hooksë¥¼ í†µí•´ ì´ë¯¸ì§€ë°ì´í„°ê°’ì„ ì´ˆê¸°í™”í•´ì£¼ì—ˆë‹¤.

## 6-2. View

```jsx
<a href={downloadHref} download="jjalbang.png">
  ì§¤ë°© ë‹¤ìš´ë¡œë“œ
</a>
```

ê·¸ë¦¬ê³  a íƒœê·¸ì˜ `download ì†ì„±`ì„ í†µí•´ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤.

# 7. ê°œì¸ì ì¸ í”¼ë“œë°±

## 7-1. í…ìŠ¤íŠ¸ì˜ í€„ë¦¬í‹°

ì´ë¯¸ì§€ì— í…ìŠ¤íŠ¸ê°€ ì‚½ì…ì€ ë˜ì§€ë§Œ ë„ˆë¬´ ê¹¨ì ¸ìˆë‹¤ëŠ” ëŠë‚Œì„ ë§ì´ ë°›ì•˜ë‹¤.

í…ìŠ¤íŠ¸ë¥¼ `Anti-Aliasing` í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‚˜, í˜¹ì€ `ë²¡í„°`ë¡œ ê·¸ë¦¬ëŠ” ê²ƒì´ ê°€ëŠ¥í•œì§€ í•œë²ˆ ì•Œì•„ë´ì•¼ê² ë‹¤.

## 7-2. ì§€ì €ë¶„í•œ styled Component

```jsx
const JJalForm = styled.form`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;

  & > p {
    font-size: 12px;
    font-family: escore7;
    color: #666;
    margin-bottom: 20px;
  }

  & > div {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 10px;

    & > label {
      font-size: 12px;

      ì´í•˜ìƒëµ...
`
```

ì•„ì§ì€ ë‚˜ì—ê²Œ ìƒì†Œí•œ íƒœê·¸ë“¤(select, option, label, canvas)ì„ ë§ì´ ì‚¬ìš©í•˜ë‹¤ë³´ë‹ˆ styled componentê°€ ì§€ì €ë¶„í•´ì¡Œë‹¤.

ê·¸ë˜ë„ íƒœê·¸ë“¤ì´ ë§ì§€ ì•Šì•„ì„œ ê·¸ë ‡ê²Œ í—·ê°ˆë¦¬ì§€ëŠ” ì•Šì§€ë§Œ ì²˜ìŒ styleì„ ì§€ì •í•  ë•Œë¶€í„° ì‹ ê²½ì„ ì¢€ ì¨ì•¼ê² ë‹¤ê³  ëŠê¼ˆë‹¤.

## 7-3. ë¦¬ë“€ì„œ ê±°ì³¤ì„ ë•Œ, ì´ë¯¸ì§€ ì˜ë¦¼í˜„ìƒ

![](./images/uing.png)

> ìœ„ì˜ ê°œì¸ ë¹„ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê³  Dockerì— ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì €ì¥í–ˆë‹¤ ë‹¤ì‹œ ë¶ˆëŸ¬ì™”ì„ ë•Œ ìƒí™©..

ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ Dockerì— ë‹´ê³  ë‹¤ì‹œ ì—´ì—ˆì„ ë•Œ ì´ë¯¸ì§€ê°€ ì˜ë¦¬ëŠ” í˜„ìƒì´ ìˆë‹¤.

> Redux Dev Tools ë¡œ ì°¨ê·¼ì°¨ê·¼ ë‹¤ì‹œ ë´ë³¼ê²ƒ.

## 7-4. Blob ê°ì²´

í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë‹¤ê°€ `Blob` ê°ì²´ì˜ ê°œë…ë„ ì•Œê²Œë˜ì—ˆëŠ”ë° ë‹¤ì‹œ í•™ìŠµí•  ê²ƒ!

# 8. ì°¸ê³  ì‚¬ì´íŠ¸

- [How to upload image into HTML5 canvas](https://stackoverflow.com/questions/10906734/how-to-upload-image-into-html5-canvas)

- [ã€ê³½ì² ìš© ì§¤ ìƒì„±ê¸°ã€, ì´ë ‡ê²Œ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤](https://wormwlrm.github.io/2019/10/13/Kwakcheolyong-Image-Creator-Development-Story.html)

- [velog ë°°ë„ˆ ìƒì„±ê¸°ë¥¼ ë§Œë“¤ì–´ ë´…ì‹œë‹¤](https://velog.io/@godori/banner-maker)

- [12/ File Apiì™€ ì´ë¯¸ì§€ ìš©ëŸ‰ ì¤„ì´ê¸°](https://feel5ny.github.io/2018/05/27/JS_12/)
