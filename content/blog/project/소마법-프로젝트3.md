---
title: ğŸ”® ì†Œë§ˆë²• í”„ë¡œì íŠ¸ -3 (graph)
date: 2020-03-02 14:03:01
category: project
draft: false
---

```toc
exclude: Table of Contents
from-heading: 1
to-heading: 6
```

# 0. Intro

- <a href="https://small-magic-project.now.sh/" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸</a>

- <a href="https://github.com/taenykim/small-magic-project" target="_blank">í”„ë¡œì íŠ¸ ê¹ƒí—ˆë¸Œì†ŒìŠ¤</a>

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 1 (container)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B81/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 2 (calculator)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B82/)

ë°ì´í„°ë“¤ì„ ê·¸ë˜í”„ë¡œ í‘œí˜„í•´ë³´ê³  ì‹¶ì–´ì„œ ë§Œë“¤ì–´ë³´ì•˜ë‹¤.

ì´ìƒí•œ ë³‘ì´ ìˆì–´ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  canvasë¥¼ ì´ìš©í•´ì„œ ë§Œë“¤ì–´ë³´ë ¤ê³  í–ˆëŠ”ë° ë§Œë“¤ê³ ë‚˜ì„œ ê²¬í•´ê°€ ë°”ë€Œì—ˆë‹¤..!

# 1. ë ˆì´ì•„ì›ƒ

![](./images/graph.png)

ê·¸ë˜í”„ëŠ” canvasë¥¼ ì´ìš©í•´ ê·¸ë ¸ê³ 

ë°ì´í„°ë¥¼ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆëŠ” form Input ìš”ì†Œë“¤ë„ ë„£ì–´ì£¼ì—ˆë‹¤.

ê·¸ë¦¬ê³  ì´ˆê¸° ë°ì´í„°ë¡œ ì„ì˜ì˜ í‚¤ë“¤ê³¼ ê°’ë“¤ì„ ë„£ì–´ì£¼ì—ˆë‹¤.

# 2. ìƒíƒœê´€ë¦¬

```js
const data = useSelector(state => state.graph)
const [graphData, setGraphData] = useState(
  data.graphData || {
    Austrailia: 500,
    India: 1800,
    USA: 500,
    Brasil: 2100,
    China: 1500,
  }
)
const entries = Object.entries(graphData)

const [country, setCountry] = useState(data.country || '')
const [population, setPopulation] = useState(data.population || '')
const [country2, setCountry2] = useState('')
const [errorMessage, setErrorMessage] = useState('')
const inputRef1 = useRef()
const inputRef2 = useRef()
```

## 2-1. ë¦¬ì•¡íŠ¸ hooks

ì»´í¬ë„ŒíŠ¸ë¥¼ class ê°€ ì•„ë‹Œ `í•¨ìˆ˜í˜•`ìœ¼ë¡œ êµ¬ì„±í•˜ê³  `í´ë¡œì €, hooks`ë¥¼ ì´ìš©í•´ì„œ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œì˜ ìƒíƒœê´€ë¦¬ë¥¼ í•˜ì˜€ë‹¤.

ìƒíƒœë³€ìˆ˜ëŠ”

> 1. `graphData` : ê·¸ë˜í”„ì— ë“¤ì–´ìˆëŠ” ê°ì²´ í˜•íƒœì˜ ë°ì´í„°

> 2. `country` : ì¶”ê°€, ìˆ˜ì •ì„ ìœ„í•œ í‚¤ê°’

> 3. `country2` : ì‚­ì œë¥¼ ìœ„í•œ í‚¤ê°’

> 4. `population` : ì¶”ê°€, ìˆ˜ì •ì„ ìœ„í•œ ë°¸ë¥˜ê°’

> 5. `errorMessage` : ì—ëŸ¬ë©”ì‹œì§€ë¥¼ ë‹´ì€ string ê°’

ì´ˆê¸° ë°ì´í„°ë¥¼ ë‚˜ë¼ì™€ ì¸êµ¬ë¡œ í•´ì„œ country, populationìœ¼ë¡œ key, value ê°’ë“¤ì„ ë³€ìˆ˜ ë„¤ì´ë° í•´ì¤¬ë‹¤.

ê·¸ë¦¬ê³  objectì˜ í‚¤ê°’ê³¼ ë°¸ë¥˜ê°’ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ entries ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤¬ê³ 

form submit í›„ì˜ ìë™ input focusë¥¼ ìœ„í•´ inputRef1, inputRef2 ë³€ìˆ˜ë„ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.

## 2-2. ë¦¬ë•ìŠ¤ hooks

ì²˜ìŒ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬ì„±í•  ë•Œ, graph reducerì˜ ì´ˆê¸°ê°’ì„ ê°€ì ¸ì˜¤ë„ë¡ ì„¤ì •í–ˆë‹¤.

ê·¸ë¦¬ê³  ë‹¤ë¥¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì“°ê¸° ìœ„í•´ ì´ ê·¸ë˜í”„ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì ì‹œ Dockerì— ë„£ì—ˆì„ ë•Œ, í˜„ì¬ ë¦¬ì•¡íŠ¸ stateë¥¼ ë¦¬ë•ìŠ¤ stateë¡œ ì˜®ê¸°ë„ë¡ ì„¤ì •í–ˆë‹¤.

ì¦‰, í•´ë‹¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ state ì¡°ì‘ì€ ë¦¬ì•¡íŠ¸ë¡œ,

í•´ë‹¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ state ì„ì‹œì €ì¥( Docker ë„˜ê¸°ê¸° )ì€ ë¦¬ë•ìŠ¤ë¡œ í•˜ì˜€ë‹¤.

# 3. Canvas

## 3-1. useEffect

```js
useEffect(() => {
  let canvasElem = document.querySelector('canvas')
  canvasElem.width = 840
  canvasElem.height = 320
  const ctx = canvasElem.getContext('2d')
  drawGrid(canvasElem, ctx)
  drawAxis(ctx)
  drawChart(ctx)
})
```

ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŒ… ëœ í›„ useEffect hooksë¥¼ í†µí•˜ì—¬ canvasë¥¼ ê·¸ë¦¬ë„ë¡ í•˜ì˜€ë‹¤.

## 3-2. drawGrid()

```js
const drawGrid = (canvasElem, ctx) => {
  let xGrid = 10
  let yGrid = 10
  let cellSize = 10
  ctx.beginPath()
  while (xGrid < canvasElem.height) {
    ctx.moveTo(0, xGrid)
    ctx.lineTo(canvasElem.width, xGrid)
    xGrid += cellSize
  }
  while (yGrid < canvasElem.width) {
    ctx.moveTo(yGrid, 0)
    ctx.lineTo(yGrid, canvasElem.height)
    yGrid += cellSize
  }
  ctx.strokeStyle = '#ccc'
  ctx.stroke()
}
```

ì „ì²´ ê·¸ë¦¬ë“œë¥¼ ê·¸ë ¤ì£¼ëŠ” í•¨ìˆ˜ ì‘ì„±

## 3-3. drawAxis()

```js
const drawAxis = ctx => {
  let yPlot = 300
  let pop = 0

  ctx.beginPath()
  ctx.strokeStyle = 'black'
  ctx.moveTo(50, 50)
  ctx.lineTo(50, 300)
  ctx.lineTo(800, 300)
  ctx.moveTo(50, 300)

  for (let i = 0; i < 10; i++) {
    ctx.strokeText(pop, 20, yPlot)
    pop += 500
    yPlot -= 50
  }
  ctx.stroke()
}
```

xì¶•ê³¼ yì¶•, xì¶•ì˜ ê°’ë“¤ì„ ê·¸ë ¤ì£¼ëŠ” í•¨ìˆ˜ ì‘ì„±

## 3-4. drawChart()

```js
const drawChart = ctx => {
  ctx.beginPath()
  ctx.strokeStyle = 'black'
  ctx.moveTo(50, 300)
  ctx.font = 'bold normal 10px Verdana'

  var xPlot = 100
  let i = 0

  for (const [country, population] of entries) {
    var populationInBlocks = population / 10
    ctx.fillText(
      country + '(' + population + ')',
      xPlot,
      i % 2 === 0
        ? 300 - populationInBlocks - 10
        : 300 - populationInBlocks - 10 + 30
    )
    ctx.lineTo(xPlot, 300 - populationInBlocks)
    ctx.arc(xPlot, 300 - populationInBlocks, 2, 0, Math.PI * 2, true)
    xPlot += 50
    i++
  }
  ctx.stroke()
}
```

ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ ì‘ì„±

## 3-5. :star: ë³€ìˆ˜ i

ê·¸ë˜í”„ì˜ ê°ê°ì˜ í…ìŠ¤íŠ¸ ê°’ë“¤ì´ ë™ì¼í•œ ìœ„ì¹˜ì— ìœ„ì¹˜í•  ê²½ìš° í…ìŠ¤íŠ¸ê°€ ê²¹ì¹˜ëŠ” í˜„ìƒì´ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ ë³€ìˆ˜ ië¥¼ í• ë‹¹í•˜ê³  ì§ìˆ˜ì¼ ê²½ìš°ëŠ” ê¼­ì§€ì  ë°‘ì— í…ìŠ¤íŠ¸ë¥¼ ì ê³  í™€ìˆ˜ì¼ ê²½ìš°ëŠ” ê¼­ì§€ì  ìœ„ì— í…ìŠ¤íŠ¸ë¥¼ ì ê²Œí•´ì„œ ê²¹ì¹˜ëŠ” í˜„ìƒì„ í”¼í•´ì£¼ì—ˆë‹¤.

# 4. ì´ë²¤íŠ¸ ì²˜ë¦¬

## 4-1. submit ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

```js
const submitHandler1 = e => {
  console.log(graphData)
  e.preventDefault()

  if (
    isNaN(Number(population)) ||
    Number(population) > 2500 ||
    Number(population) < 0
  ) {
    setErrorMessage('0~2500ì‚¬ì´ì˜ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.')
    return
  }
  let obj = { ...graphData }
  obj[country] = Number(population)
  // obj.county = population not same!!
  let graphData_temp = Object.assign({}, obj)
  setGraphData(graphData_temp)
  setCountry('')
  setPopulation('')
  setErrorMessage('')
  inputRef1.current.focus()
}
```

## 4-2. :star: isNaN, number condition

ê°’ inputì˜ ê°’ì´ ìˆ«ìê°€ ì•„ë‹ ê²½ìš°, ê·¸ë¦¬ê³  ì…ë ¥ê°’ì˜ ë²”ìœ„ê°€ canvas ë¥¼ ë„˜ì„ ê²½ìš° í•¸ë“¤ë§í•˜ëŠ” ì¡°ê±´ë¬¸ì„ ë„£ì–´ì£¼ì—ˆë‹¤.

ê·¸ë¦¬ê³  ì¡°ê±´ë¬¸ì— ê±¸ë¦´ ê²½ìš°, ì—ëŸ¬ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê²Œë” í•´ì£¼ì—ˆë‹¤.

## 4-3. :star: :star: obj

í•´ë‹¹ í‚¤ì™€ ê°’ì´ ì •ìƒì ì¼ ê²½ìš°, stateë¥¼ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ë©´ì„œ ì—…ë°ì´íŠ¸í•´ì£¼ë ¤ í–ˆë‹¤.

ìƒˆë¡œìš´ obj ë³€ìˆ˜ì— spread ë¬¸ë²•(...)ì„ í†µí•´ ê¸°ì¡´ stateë¥¼ ì´ˆê¸°í™”í•´ì£¼ì—ˆê³  objì— ìƒˆë¡œìš´ í‚¤, ê°’ì„ ë„£ì–´ì¤€ ë’¤ ì—…ë°ì´íŠ¸ í•´ì£¼ì—ˆë‹¤.

ì—¬ê¸°ì„œ ìƒˆë¡­ê²Œ ì•ˆ ì ì€,

`obj.key = value`ë¥¼ í†µí•œ obj ì—…ë°ì´íŠ¸ëŠ” ì‹¤ì œë¡œ keyê°’ìœ¼ë¡œ keyê°€ ë“¤ì–´ê°”ë‹¤.

ì´ë¥¼ í”¼í•˜ê¸° ìœ„í•´ì„œ `obj[key] = value`ë¥¼ ì´ìš©í•´ì•¼ ì •ìƒì ìœ¼ë¡œ keyì˜ stringê°’ì´ keyë¡œ ë“¤ì–´ê°”ë‹¤.

> delete ì˜ ê²½ìš°ë„ ë§ˆì°¬ê°€ì§€ë‹¤. `delete obj[country2]`

# 5. ê°œì¸ì ì¸ í”¼ë“œë°±

## 5-1. canvasëŠ” read only

ì‚¬ì‹¤ ê·¸ë˜í”„ ì•ˆì— ìˆëŠ” ì„ ì´ë‚˜ ì ì— ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•˜ê³ ì‹¶ì—ˆë‹¤.

ê·¼ë° canvasëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ ë„í˜•ì„ ê·¸ë¦´ ë¿ DOMì²˜ëŸ¼ ì§ì ‘ ì•ˆì˜ ë„í˜•ì— ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•  ìˆ˜ ì—†ë‹¤.

ì‹¤ì œ canvasì— ì´ë²¤íŠ¸ë¥¼ ê±¸ë ¤ë©´ canvas ìì²´ì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë‹¬ê±°ë‚˜ í•´ì•¼í•œë‹¤.

ì•„ì§ canvasë¥¼ ììœ ìì¬ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì‹¤ë ¥ì´ê¸°ë„ í•˜ê³  canvas ë‚´ë¶€ì˜ ë„í˜•ì— ì´ë²¤íŠ¸ë¥¼ ë„£ì§€ ëª»í•œê²Œ ì¢€ ì•„ì‰½ë‹¤.

## 5-2. ë¼ì´ë¸ŒëŸ¬ë¦¬

ê·¸ë˜í”„ì— ì´ë²¤íŠ¸ë¥¼ ë„£ëŠ” ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

ë‹¤ìŒ í”„ë¡œì íŠ¸ë¡œ ê·¸ë˜í”„, ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ë³´ê³  ì‹¶ë‹¤.

## 5-3. ë””ìì¸

ë””ìì¸ì´ ë§¤ìš° êµ¬ë¦¬ë‹¤..!

## 5-4. ë„¤ì´ë°

ë³€ìˆ˜ë¥¼ country, population ì²˜ëŸ¼ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ëª©ì ì„±ì´ ë‹¤ì†Œ ë§ì§€ ì•ŠëŠ” ë„¤ì´ë°ì„ í–ˆë‹¤.

1. ì´ˆê¸° ë°ì´í„°ë¥¼ ë‚˜ë¼ì™€ ì¸êµ¬ë¡œ í•´ì„œ

2. ì‚¬ìš©ìì—ê²ŒëŠ” ë³´ì´ì§€ ì•Šê³  ê°œë°œì ì…ì¥ì—ì„œ ì´í•´í•  ìˆ˜ ìˆìœ¼ë©´ ëœë‹¤.

ë¼ëŠ” í•©ë¦¬í™”ë¥¼ í•  ìˆ˜ ìˆê² ì§€ë§Œ,

country, country2 ì´ëŸ° ë³€ìˆ˜ ë„¤ì´ë°ì€ í•©ë¦¬í™” ìì²´ë„ ë¶ˆê°€ëŠ¥í•˜ë‹¤.

> ê°œë°œìë„ í—·ê°ˆë¦¬ê¸° ë•Œë¬¸..

í•´ë‹¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ê¸°ëŠ¥ì´ ë§ì€ í¸ì´ ì•„ë‹ˆë¼ì„œ ë„¤ì´ë°ì„ ìˆ˜ì •í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, ì²˜ìŒ ë³€ìˆ˜ ë„¤ì´ë°ì„ ì§€ì„ ë•Œ ê·¸ë˜ë„ ì¢€ ë” ì‹ ê²½ì“°ëŠ” ìŠµê´€ì„ ë“¤ì—¬ì•¼ê² ë‹¤.
