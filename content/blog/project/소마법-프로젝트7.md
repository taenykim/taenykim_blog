---
title: ğŸ”® ì†Œë§ˆë²• í”„ë¡œì íŠ¸ -7 (avengers) (ì‘ì„±ì¤‘)
date: 2020-03-13 19:03:45
category: project
draft: false
---

```toc
exclude: Table of Contents
from-heading: 1
to-heading: 5
```

# \#. Project Map

- <a href="https://small-magic-project.now.sh/" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸</a> :apple:

- <a href="https://github.com/taenykim/small-magic-project" target="_blank">í”„ë¡œì íŠ¸ ê¹ƒí—ˆë¸Œì†ŒìŠ¤</a>

<br/>

> ì œì‘ë…¸íŠ¸

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 1 (container)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B81/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 2 (calculator)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B82/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 3 (graph)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B83/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 4 (crawling)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B84/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 5 (today)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B85/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 6 (jjal)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B86/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 7 (avengers)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B87/)

# 0. Intro

ë“œë˜ê·¸ ì•¤ ë“œë ê¸°ëŠ¥ì„ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜.

`react-beautiful-dnd` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í–ˆê³ , ì–´ë²¤ì ¸ìŠ¤ ìºë¦­í„°ë“¤ì„ ì»¨í…ì¸ ë¡œ ì‚¬ìš©í•´ë³´ì•˜ë‹¤.

# 1. ë ˆì´ì•„ì›ƒ

## 1-1. ë©”ì¸í™”ë©´

![](./images/avengers.png)

í™”ë©´ êµ¬ì„±ì€ ë“œë˜ê·¸ì•¤ë“œë ê¸°ëŠ¥ì´ ë“¤ì–´ìˆëŠ” ìƒë‹¨ ì»¨í…Œì´ë„ˆì™€ ë°ì´í„°ë¥¼ í™”ë©´ì— ê·¸ë ¤ì£¼ëŠ” í•˜ë‹¨ ì»¨í…Œì´ë„ˆ, í¬ê²Œ ë‘ ê°œë¡œ êµ¬ì„±í•˜ì˜€ë‹¤.

## 1-2. ì»´í¬ë„ŒíŠ¸

```jsx
<BackgroundContainer>
  <ContentsMenubar name="avengers" data={dndData} />
  <Description>Try Drag & Drop</Description>
  <TopContainer>
    <DragDropContext>
      <DndContainer>{/* ë“œë˜ê·¸ì•¤ ë“œë ê´€ë ¨ code */}</DndContainer>
    </DragDropContext>
  </TopContainer>
  <Description>Make them friends</Description>
  <div className="mobile_description">scroll >>> </div>
  <BottomContainer>{/* ë°ì´í„° -> ë·° code */}</BottomContainer>
</BackgroundContainer>
```

> **ContentsMenubar** : ë¦¬ë“€ì„œì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ë¦¬ì…‹ì‹œí‚¬ ìˆ˜ ìˆëŠ” ë©”ë‰´ë°”

> **Description** : ì„¤ëª… (styled-component)

> **TopContainer** : ë“œë˜ê·¸ì•¤ ë“œë ê¸°ëŠ¥, react-beautiful-dnd ì˜ `DragDropContext API`ë¥¼ ì‚¬ìš©í–ˆë‹¤.

> **div.mobile_description** : widthê°€ BottomContainer ë³´ë‹¤ ì‘ì•„ì§€ë©´ ìŠ¤í¬ë¡¤í•˜ë¼ëŠ” ì„¤ëª…ë„ ë³´ì´ë„ë¡ í•´ì£¼ì—ˆë‹¤.

> **BottomContainer** : ë°ì´í„°ë¥¼ í™”ë©´ì— ê·¸ë ¤ì£¼ëŠ” ì—­í• 

# 2. ìƒíƒœê´€ë¦¬

```jsx
const data = useSelector(state => state.avengers)
const [dndData, setDndData] = useState(data)
```

## 2-1. ë¦¬ì•¡íŠ¸ state

**ë¦¬ì•¡íŠ¸ hooks**ë¥¼ ì´ìš©í•´ì„œ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œì˜ ìƒíƒœê´€ë¦¬ë¥¼ í•˜ì˜€ë‹¤.

ê·¸ë¦¬ê³  ë“œë˜ê·¸ì•¤ ë“œëìœ¼ë¡œ ë°ì´í„°ì˜ ë³€ê²½ì‹œ, ë¶ˆë³€ì„±ì„ ìœ ì§€ì‹œì¼œì£¼ë©° ë°ì´í„°ë¥¼ ë°”ê¾¸ì–´ì£¼ì—ˆë‹¤.

> **dndData** : ê°ì²´í˜•íƒœì˜ í˜„ì¬ column, itemë“¤ì˜ ë°ì´í„°

## 2-2. ë¦¬ë•ìŠ¤ store

**ë¦¬ë•ìŠ¤ hooks**ë¥¼ ì´ìš©í–ˆë‹¤.

contentsMenuBarì—ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `useDispatch`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ 

`useSelector`ë¡œ ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ë‹¤.

```js
// reducers > avengers.js

const initialState = {
  items: {
    'item-1': { id: 'item-1', content: 'Captain America', src: 'captain.jpg' },
    'item-2': { id: 'item-2', content: 'IonMan', src: 'ironman.jpg' },
    'item-3': { id: 'item-3', content: 'Thor', src: 'thor.jpg' },
    'item-4': { id: 'item-4', content: 'Hulk', src: 'hulk.jpg' },
    'item-5': { id: 'item-5', content: 'Spiderman', src: 'spider.jpg' },
    'item-6': { id: 'item-6', content: 'Groot', src: 'groot.jpg' },
    'item-7': { id: 'item-7', content: 'Rocket', src: 'rocket.jpg' },
    'item-8': { id: 'item-8', content: 'Thanos', src: 'thanos.png' },
  },
  columns: {
    'column-1': {
      id: 'column-1',
      title: 'Heros',
      itemIds: [
        'item-1',
        'item-2',
        'item-3',
        'item-4',
        'item-5',
        'item-6',
        'item-7',
      ],
    },
    'column-2': {
      id: 'column-2',
      title: 'villain',
      itemIds: ['item-8'],
    },
  },
  columnOrder: ['column-1', 'column-2'],
}
```

> avengers ë¦¬ë“€ì„œì˜ ì´ˆê¸° state

# 3. react-beauifult-dnd

## 3-1. DragDropContext

[https://github.com/atlassian/react-beautiful-dnd](https://github.com/atlassian/react-beautiful-dnd)

![](./images/react-beautiful-dnd.gif)

```jsx
<DragDropContext
  onDragStart={onDrageStartHandler}
  onDragUpdate={onDrageUpdateHandler}
  onDragEnd={onDrageEndHandler}
>
  <DndContainer>
    {dndData.columnOrder.map(columnId => {
      const column = dndData.columns[columnId]
      const items = column.itemIds.map(itemId => dndData.items[itemId])

      return <Column key={column.id} column={column} items={items} />
    })}
  </DndContainer>
</DragDropContext>
```

<hr/>

### :apple: onDrageStartHandler

> dnd ì‹œì‘ì‹œì 

```jsx
const onDrageStartHandler = () => {
  for (
    let i = 0;
    i < document.querySelectorAll('.droppable_table').length;
    i++
  ) {
    document.querySelectorAll('.droppable_table')[
      i
    ].style.background = `rgba(255,141,217,0.2)`
  }
}
```

TopConatinerì—ì„œ ë“œë˜ê·¸ì•¤ë“œëì´ ë°œìƒí•˜ëŠ” column ë¶€ë¶„ì˜ classë¥¼ '.droppable_table'ë¡œ ì •ì˜í•´ì£¼ê³  dndê°€ ì‹œì‘ë˜ë©´ ê·¸ column ë°°ê²½ìƒ‰ì„ ë³€ê²½í•´ì£¼ì—ˆë‹¤.

<hr/>

### :apple: onDrageUpdateHandler

> dnd ì—…ë°ì´íŠ¸ë˜ëŠ” ì‹œì 

```jsx
const onDrageUpdateHandler = update => {
  // ...
}
```

ë“œë˜ê·¸ì•¤ë“œë ì¤‘, ë“œë˜ê·¸ ë„ì¤‘ ë°œìƒí•˜ëŠ” í•¨ìˆ˜. ì‚¬ìš©í•˜ì§€ ì•ŠìŒ.

<hr/>

### :apple: onDrageEndHandler

> dnd ì¢…ë£Œì‹œì 

```jsx
const onDrageEndHandler = result => {
  document.body.style.color = 'inherit'
  document.body.style.background = 'inherit'
  for (
    let i = 0;
    i < document.querySelectorAll('.droppable_table').length;
    i++
  ) {
    document.querySelectorAll('.droppable_table')[
      i
    ].style.background = `inherit`
  }
  const { destination, source, draggableId } = result
  if (!destination) {
    return
  }
  if (
    destination.droppableId === source.droppableId &&
    destination.index === source.index
  ) {
    return
  }
  const start = dndData.columns[source.droppableId] // 'column-1'
  const finish = dndData.columns[destination.droppableId]

  if (start === finish) {
    const newItemIds = Array.from(start.itemIds)
    newItemIds.splice(source.index, 1)
    newItemIds.splice(destination.index, 0, draggableId)
    const newColumn = {
      ...start,
      itemIds: newItemIds,
    }
    const newDndData = {
      ...dndData,
      columns: {
        ...dndData.columns,
        [newColumn.id]: newColumn,
      },
    }
    setDndData(newDndData)
    return
  }

  const startItemIds = Array.from(start.itemIds)
  startItemIds.splice(source.index, 1)
  const newStart = {
    ...start,
    itemIds: startItemIds,
  }

  const finishItemIds = Array.from(finish.itemIds)
  finishItemIds.splice(destination.index, 0, draggableId)
  const newFinish = {
    ...finish,
    itemIds: finishItemIds,
  }

  const newDndData = {
    ...dndData,
    columns: {
      ...dndData.columns,
      [newStart.id]: newStart,
      [newFinish.id]: newFinish,
    },
  }
  setDndData(newDndData)
  return
}
```

> ë“œë˜ê·¸ ê°€ëŠ¥í•œ ì•„ì´í…œì„ ë“œë˜ê·¸í•´ì„œ ë“œëí•˜ë©´ ë°œìƒí•˜ëŠ” í•¨ìˆ˜

í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œ, resultë¼ëŠ” ê°ì²´ë¥¼ ì „ë‹¬ë°›ëŠ”ë‹¤. resultê°ì²´ ë‚´ë¶€ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìƒê²¼ë‹¤.

```jsx
const result = {
  // ë“œë˜ê·¸ í•œ item ID
  draggableId: '',
  // ë“œë˜ê·¸ ì‹œì‘ ì‹œì  column ì •ë³´
  source: {
    index: 2,
    droppableId: '',
  },
  // ë“œë˜ê·¸ ì¢…ë£Œ ì‹œì  column ì •ë³´
  destination: {
    index: 1,
    droppableId: '',
  },
}
```

ì´ ì •ë³´ë¥¼ í†µí•´ì„œ ì‹¤ì œ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•´ì£¼ì—ˆë‹¤.

ë¨¼ì €, ë“œë˜ê·¸ ì¢…ë£Œ ì‹œ, ì‹œì‘ì ê³¼ ëª©ì ì§€ê°€ ë™ì¼í•  ê²½ìš°ëŠ” ì¡°ê±´ë¬¸ ì²˜ë¦¬ë¥¼ í†µí•´ ë‹¤ìŒ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê²Œë” í•´ì£¼ì—ˆê³ 

ì‹¤ì œ ë³€ê²½ì´ ì¼ì–´ë‚¬ì„ ê²½ìš°, **ë™ì¼í•œ columnì—ì„œ ë³€ê²½**ì´ ì¼ì–´ë‚¬ì„ ë•Œì™€ **ë‹¤ë¥¸ columnìœ¼ë¡œ ì´ë™í–ˆì„ ê²½ìš°**, ë‘ê°€ì§€ë¥¼ ì¡°ê±´ë¬¸ì„ í†µí•´ ë”°ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•´ì£¼ì—ˆë‹¤.

<hr/>

### ë™ì¼í•œ columnì—ì„œ ë³€ê²½

```jsx
const newItemIds = Array.from(start.itemIds)
newItemIds.splice(source.index, 1)
newItemIds.splice(destination.index, 0, draggableId)
const newColumn = {
  ...start,
  itemIds: newItemIds,
}
const newDndData = {
  ...dndData,
  columns: {
    ...dndData.columns,
    [newColumn.id]: newColumn,
  },
}
setDndData(newDndData)
return
```

ë¦¬ì•¡íŠ¸ì—ì„œ ìƒíƒœ ë³€ê²½ì„ ê°ì§€í•˜ê¸° ìœ„í•´ì„œ ê°ì²´ë¥¼ ì§ì ‘ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ hooksë¡œ ë„£ì–´ì£¼ì–´ì•¼í•œë‹¤.

> flux íŒ¨í„´

ê·¸ë˜ì„œ ê°ì²´ ë‚´ë¶€ column ë°°ì—´ì„ ë³€ê²½í•´ ì£¼ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  source ì •ë³´ì™€ destination ì •ë³´ì— ë§ê²Œ ë°°ì—´ì„ ì—…ë°ì´íŠ¸ í•´ì¤€ í›„ì—, ìŠ¤í”„ë ˆë“œ ë¬¸ë²•ìœ¼ë¡œ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ë©´ì„œ hooksë¡œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í•´ì£¼ì—ˆë‹¤.

<hr/>

### ë‹¤ë¥¸ columnìœ¼ë¡œ ì´ë™

```jsx
const startItemIds = Array.from(start.itemIds)
startItemIds.splice(source.index, 1)
const newStart = {
  ...start,
  itemIds: startItemIds,
}

const finishItemIds = Array.from(finish.itemIds)
finishItemIds.splice(destination.index, 0, draggableId)
const newFinish = {
  ...finish,
  itemIds: finishItemIds,
}

const newDndData = {
  ...dndData,
  columns: {
    ...dndData.columns,
    [newStart.id]: newStart,
    [newFinish.id]: newFinish,
  },
}
setDndData(newDndData)
return
```

ë“œë˜ê·¸í•œ itemì´ ë‹¤ë¥¸ columnìœ¼ë¡œ ì´ë™í–ˆì„ ê²½ìš°ëŠ” columnì„ ê°ê° ìˆ˜ì •í•˜ê³  ì—…ë°ì´íŠ¸í•´ì£¼ì—ˆë‹¤.

## 3-2. Droppable

### :apple: provided

(ì‘ì„±ì¤‘)

# 4. ë·° (View)

(ì‘ì„±ì¤‘)
