---
title: ğŸ”® ì†Œë§ˆë²• í”„ë¡œì íŠ¸ -12 (racingcar)
date: 2020-04-28 22:04:08
category: project
draft: false
---

ì´ë²ˆì— ë§Œë“¤ì–´ë³¸ ì†Œë§ˆë²• í”„ë¡œì íŠ¸ëŠ” ìë™ì°¨ ê²½ì£¼ê²Œì„ ì–´í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ, OOP study ë¯¸ì…˜ì„ ë³€í˜•í•´ì„œ ì œì‘í•´ë³´ì•˜ë‹¤. **MVVM** íŒ¨í„´ê³¼ **FLUX** íŒ¨í„´ êµ¬í˜„ê³¼ **ìœ ë‹›í…ŒìŠ¤íŠ¸**ì— ì¤‘ì‹¬ì„ ë‘ì–´ì„œ ì½”ë“œë¥¼ ì§œë³´ì•˜ë‹¤. ë””ìì¸ íŒ¨í„´ì— ëŒ€í•œ ì„¤ëª…ê³¼ í…ŒìŠ¤íŠ¸ì½”ë“œ ì‘ì„± ë°©ë²• ë° íŒì€ [ì—¬ê¸°](https://taeny.dev/javascript/oopstudy2/)ì— í¬ìŠ¤íŒ…í•˜ì˜€ê³ , ì—¬ê¸°ì„œëŠ” êµ¬í˜„í•œ ì½”ë“œì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤.

<hr/>

```toc
exclude: Table of Contents
from-heading: 1
to-heading: 1
```

# \#. Project Map

- :apple: <a href="https://small-magic-project.now.sh/" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸</a>

- :apple: <a href="https://small-magic-project.now.sh/racingcar" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸/racingcar</a>

* :fire: <a href="https://github.com/taenykim/small-magic-project" target="_blank">í”„ë¡œì íŠ¸ ê¹ƒí—ˆë¸Œì†ŒìŠ¤</a>

<br/>

<details>
<summary>ì œì‘ë…¸íŠ¸ í•œëˆˆì—ë³´ê¸°[ì ‘ê¸°/í¼ì¹˜ê¸°]</summary>
<div markdown="1">

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 1 (container)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B81/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 2 (calculator)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B82/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 3 (graph)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B83/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 4 (crawling)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B84/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 5 (today)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B85/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 6 (jjal)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B86/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 7 (avengers)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B87/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 8 (maskmap)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B88/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 9 (loading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B89/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 10 (lazyloading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B810/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 11 (music)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B811/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 12 (racingcar)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B812/)

</div>
</details>

# 1. Layout

## 1-1. ë©”ì¸í™”ë©´

![](./images/racingcarmain.png)

ë©”ì¸í™”ë©´ì—ëŠ” ìë™ì°¨ì´ë¦„ ì…ë ¥ inputê³¼ ì‹œë„íšŸìˆ˜ ì…ë ¥ inputì„ ë‘ì—ˆë‹¤.

## 1-2. ê²°ê³¼í™”ë©´

![](./images/racingcarmain2.png)

ê²°ê³¼í™”ë©´ì—ì„œëŠ” 1ì´ˆë§ˆë‹¤ íšŸìˆ˜ë¥¼ ëŠ˜ë¦¬ë©° ê° íšŸìˆ˜ë§ˆë‹¤ ìë™ì°¨ì˜ ì´ë™ê±°ë¦¬ë¥¼ í‘œì‹œí•˜ê³ , ë§ˆì§€ë§‰ì—ëŠ” ìµœì¢… ìš°ìŠ¹ìë¥¼ ì¶œë ¥í•˜ë„ë¡ í•˜ì˜€ë‹¤.

# 2. Container

## 2-1. App.tsx

```tsx
// App.tsx
const App = () => {
    return (
        <Container>
            <form onSubmit={onSubmit}>
                {/*...*/}
            </form>
            <Processes process={process} />
            <Result result={result} />
        </Container>
    )
```

ì „ì²´ ì»¨í…ì¸  ë ˆì´ì•„ì›ƒì„ êµ¬ì„±í•˜ëŠ” App.tsx ì—ëŠ” ì‚¬ìš©ìì—ê²Œ ì…ë ¥ì„ ë°›ëŠ” **form ì—˜ë¦¬ë¨¼íŠ¸**, ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” **Processes ì»´í¬ë„ŒíŠ¸**, ê·¸ë¦¬ê³  ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” **Result ì»´í¬ë„ŒíŠ¸** ì´ 3ê°œë¡œ êµ¬ì„±í•˜ì˜€ë‹¤.

## 2-2. input value

```tsx
const [carNames, setCarNames] = useState('')
const [count, setCount] = useState('')

const onChangeCarNames = useCallback(e => {
  setCarNames(e.target.value)
}, [])

const onChangeCount = useCallback(e => {
  setCount(e.target.value)
}, [])

return (
  <input id="carNames" type="text" value={carNames} onChange={onChangeCarNames}></input>
  <input id="count" type="text" value={count} onChange={onChangeCount}></input>
)
```

ì‚¬ìš©ìì˜ ì…ë ¥ ìƒíƒœê´€ë¦¬ëŠ” react hooks ë¥¼ ì‚¬ìš©í–ˆë‹¤.

# 3. Validator

ìœ íš¨ì„± ê²€ì‚¬ëŠ” formValidator ëª¨ë“ˆì„ ë§Œë“¤ì–´ì„œ ë”°ë¡œ ê´€ë¦¬í•˜ì˜€ë‹¤.

```ts
// formValidator.ts

const validateInput = (carNames: string, count: string) => {
  let _carNames = carNames.split(',')
  _carNames = trimCarNameBlank(_carNames)
  _carNames = _carNames.filter(v => v !== '')

  if (_carNames.length === 0) {
    return 'CAR_NAME_IS_BLANK_ERROR'
  }

  if (count === '') {
    return 'COUNT_IS_BLANK_ERROR'
  }

  if (!checkCarNameLength(_carNames)) {
    return 'CAR_NAME_LENGTH_ERROR'
  }

  if (!checkCountIsNumber(count)) {
    return 'COUNT_IS_NOT_NUMBER_ERROR'
  }
  return _carNames
}

const checkCarNameLength = (carNames: string[]) => {
  const MAX_CARNAME_LENGTH = 5
  for (let i = 0; i < carNames.length; i++) {
    if (carNames[i].length > MAX_CARNAME_LENGTH) return false
  }
  return true
}

const trimCarNameBlank = (carNames: string[]) => {
  return carNames.map(carName => carName.trim())
}

const checkCountIsNumber = (count: string) => {
  if (count.match(/\D/g)) return false
  return true
}

export {
  validateInput,
  checkCarNameLength,
  trimCarNameBlank,
  checkCountIsNumber,
}
```

```tsx
// App.tsx

import { validateInput } from '../modules/formValidator'

const validator = validateInput(carNames, count)
if (validator === 'CAR_NAME_IS_BLANK_ERROR') {
  return setCarNameIsBlankError(true)
}
if (validator === 'COUNT_IS_BLANK_ERROR') {
  return setCountIsBlankError(true)
}
if (validator === 'CAR_NAME_LENGTH_ERROR') {
  return setCarNameLengthError(true)
}
if (validator === 'COUNT_IS_NOT_NUMBER_ERROR') {
  return setCountIsNotNumberError(true)
}
const _carNames = validator
```

validateInput í•¨ìˆ˜ë¡œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ìë™ì°¨ë“¤ ì´ë¦„ê³¼ ì‹œë„íšŸìˆ˜ë¥¼ ë°›ì•„, ìë™ì°¨ì´ë¦„ì´ ê³µë°±ì´ ì•„ë‹Œì§€, ìë™ì°¨ì´ë¦„ì´ 5ë³´ë‹¤ í° ê²½ìš°ê°€ ì—†ëŠ”ì§€, ì‹œë„íšŸìˆ˜ê°€ ê³µë°±ì´ ì•„ë‹Œì§€, ì‹œë„íšŸìˆ˜ê°€ ìˆ«ìì¸ì§€ ê²€ì‚¬í•˜ëŠ” ì½”ë“œë¥¼ ë„£ì–´ì£¼ì—ˆë‹¤.

ë§Œì•½ì— ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ì‹œ, react hooksë¥¼ ì´ìš©í•´ì„œ í•´ë‹¹ ì¡°ê±´ì— ë§ê²Œ Error ìƒíƒœë¥¼ ë³€ê²½í•˜ë„ë¡ ì§œì£¼ì—ˆë‹¤.

```tsx
// App.tsx

return (
  <div>
    {carNameLengthError && (
      <div style={{ color: 'red' }}>ì—ëŸ¬! ìë™ì°¨ì´ë¦„ì€ 5ì´í•˜ë¡œ í•´ì•¼í•©ë‹ˆë‹¤</div>
    )}
    {carNameIsBlankError && (
      <div style={{ color: 'red' }}>
        ì—ëŸ¬! ìë™ì°¨ì´ë¦„ì€ ê³µë°±ì´ ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤
      </div>
    )}
    {countIsBlankError && (
      <div style={{ color: 'blue' }}>
        ì—ëŸ¬! ì‹œë„í•  íšŸìˆ˜ëŠ” ê³µë°±ì´ ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤
      </div>
    )}
    {countIsNotNumberError && (
      <div style={{ color: 'blue' }}>ì—ëŸ¬! ì‹œë„í•  íšŸìˆ˜ëŠ” ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ì˜¤</div>
    )}
  </div>
)
```

Error ìƒíƒœëŠ” ì‚¬ìš©ìê°€ ë‹¤ì‹œ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì…ë ¥í–ˆì„ ë•ŒëŠ” reset ë˜ë„ë¡ ì½”ë“œë¥¼ ì§œì£¼ì—ˆë‹¤.

```tsx
// App.tsx

const onSubmit = useCallback(
  e => {
    e.preventDefault()

    setCarNameIsBlankError(false)
    setCarNameLengthError(false)
    setCountIsBlankError(false)
    setCountIsNotNumberError(false)
  },
  [carNames, count]
)
```

# 4. Car ê°ì²´

## 4-1. Car class

Car ê°ì²´ëŠ” classí˜•íƒœë¡œ ë§Œë“¤ì–´ì£¼ì—ˆê³ , name,position í”„ë¡œí¼í‹°ì™€ go ë©”ì†Œë“œë¥¼ ë„£ì—ˆë‹¤.

```ts
// Car.ts

export default class Car {
  name: string
  position = 0

  constructor(name: string) {
    this.name = name
  }
  go() {
    this.position = this.position + 1
  }
}
```

## 4-1. Car ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

Carê°ì²´ëŠ” ìƒì„±ìí•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ Car ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ê³ , ì…ë ¥í•œ ìë™ì°¨ì˜ ìˆ«ìë§Œí¼ ë°°ì—´ì— pushí•˜ë„ë¡ ì½”ë“œë¥¼ ì§°ë‹¤. ê·¸ë¦¬ê³  ëª¨ë“  ìë™ì°¨ì— ëŒ€í•œ ë¡œì§ì€ cars ë°°ì—´ì—ì„œ ë‹´ë‹¹í•  ìˆ˜ ìˆê²Œë” í•´ì£¼ì—ˆë‹¤.

```tsx
const makeCars = (carNames: string[]) => {
  const _cars = []
  for (let i = 0; i < carNames.length; i++) {
    _cars.push(new Car(carNames[i]))
  }
  return _cars
}

const cars = makeCars(carNames)
```

# 5. racingCar ëª¨ë“ˆ

## 5-1. ìë™ì°¨ ì´ë™ê³¼ ê²°ê³¼ ì¶œë ¥

ìë™ì°¨ ì´ë™ì— ëŒ€í•œ ì¶œë ¥ê³¼ ê²°ê³¼ ì¶œë ¥ì€ `setTimeout` APIì™€ hooksë¥¼ ì´ìš©í•´ì„œ, 1ì´ˆë§ˆë‹¤ ìë™ì°¨ë¥¼ ì´ë™í•˜ê³  ì¶œë ¥ì„ ê°±ì‹ í•˜ë„ë¡ ì½”ë“œë¥¼ ì§œì£¼ì—ˆë‹¤.

```tsx
const [process, setProcess] = useState<null | JSX.Element>(null)
const [result, setResult] = useState<null | JSX.Element>(null)

let _count = Number(count)
for (let i = 0; i < _count; i++) {
  timer = setTimeout(() => {
    moveCars(cars)
    setProcess(makeProcess(i, cars))
    if (i === _count - 1) {
      setResult(makeResult(cars))
    }
  }, 1000 * i)
}
```

## 5-2. racingCar í•¨ìˆ˜ íë¦„

```js
// racingCarModule
{
moveCars : 'ìë™ì°¨ë“¤ ì´ë™',
moveCar  : 'ìë™ì°¨ ê°ì²´ í•˜ë‚˜ ì´ë™',
checkMoveCarCondition : 'ìë™ì°¨ê°€ ì´ë™í• ì§€ë§ì§€ ì¡°ê±´ì²˜ë¦¬',
makeProcess : 'ìë™ì°¨ ì´ë™ê±°ë¦¬ì— ëŒ€í•œ ì¶œë ¥(jsx) ë¦¬í„´',
makeDistance : 'ìë™ì°¨ ì´ë™ê±°ë¦¬(-) ë¬¸ìì—´ ë¦¬í„´',
makeResult : 'ìµœì¢… ê²°ê³¼ì— ëŒ€í•œ ì¶œë ¥(jsx) ë¦¬í„´',
getWinner : 'positionê°’ì´ ê°€ì¥ í° ìë™ì°¨ ë¦¬í„´',
}

```

ì´ëŸ° ì‹ìœ¼ë¡œ, í•¨ìˆ˜ëŠ” ìê¸° ê¸°ëŠ¥ë§Œ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ìµœëŒ€í•œ ë§ì´ ìª¼ê°œì£¼ì—ˆë‹¤.

# 6. Test

```ts
import {
  checkCarNameLength,
  trimCarNameBlank,
  checkCountIsNumber,
  validateInput,
} from './formValidator'

describe('validateInput í•¨ìˆ˜', () => {
  it('ë¹ˆë¬¸ìì—´ì¼ ë•Œ, ì˜ ê±¸ëŸ¬ë‚´ëŠ”ì§€ í™•ì¸', () => {
    expect(validateInput('', '')).toBe('CAR_NAME_IS_BLANK_ERROR')
  })
  it('ìë™ì°¨ì´ë¦„ê¸¸ì´ê°€ 5ì´ˆê³¼í•  ê²½ìš° ì˜ ê±¸ëŸ¬ë‚´ëŠ”ì§€ í™•ì¸', () => {
    expect(validateInput('123456', '')).toBe('CAR_NAME_LENGTH_ERROR')
  })
  it('ì‹œë„í•  íšŸìˆ˜ê°€ ìˆ«ìê°€ ì•„ë‹ ê²½ìš° ì˜ ì œê±°ë˜ëŠ”ì§€ í™•ì¸', () => {
    expect(validateInput('126,a', 'aa')).toBe('COUNT_IS_NOT_NUMBER_ERROR')
  })
})

describe('checkCarNameLength í•¨ìˆ˜', () => {
  it('ìë™ì°¨ì´ë¦„ê¸¸ì´ê°€ 5ì´ˆê³¼í•  ê²½ìš° ì˜ ê±¸ëŸ¬ë‚´ëŠ”ì§€ í™•ì¸', () => {
    expect(checkCarNameLength(['123456', '123'])).toBe(false)
  })
})

describe('trimCarNameBlank í•¨ìˆ˜', () => {
  it('ìë™ì°¨ì´ë¦„ì´ ê³µë°±ì¼ ê²½ìš° ì˜ ì œê±°ë˜ëŠ”ì§€ í™•ì¸', () => {
    expect(trimCarNameBlank(['   ', ' '])).toStrictEqual(['', ''])
  })
})

describe('checkCountIsNumber í•¨ìˆ˜', () => {
  it('ì‹œë„í•  íšŸìˆ˜ê°€ ìˆ«ìê°€ ì•„ë‹ ê²½ìš° ì˜ ì œê±°ë˜ëŠ”ì§€ í™•ì¸', () => {
    expect(checkCountIsNumber('ã…')).toStrictEqual(false)
  })
  it('ì‹œë„í•  íšŸìˆ˜ê°€ ìˆ«ìê°€ ì•„ë‹ ê²½ìš° ì˜ ì œê±°ë˜ëŠ”ì§€ í™•ì¸', () => {
    expect(checkCountIsNumber('123a')).toStrictEqual(false)
  })
  it('ì‹œë„í•  íšŸìˆ˜ê°€ ìˆ«ìê°€ ì•„ë‹ ê²½ìš° ì˜ ì œê±°ë˜ëŠ”ì§€ í™•ì¸', () => {
    expect(checkCountIsNumber('123')).toStrictEqual(true)
  })
})
```

> í…ŒìŠ¤íŠ¸ëŠ” ì•„ì§ ìµìˆ™ì§€ ì•ŠëŠ” ê²ƒ ê°™ë‹¤. ì¢€ ë” í•™ìŠµí•  ê²ƒ! [í…ŒìŠ¤íŠ¸ ì‘ì„±ê·œì¹™ ë° íŒ](https://taeny.dev/javascript/oopstudy2/#6-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1%EA%B7%9C%EC%B9%99--%ED%8C%81)

# 7. Self-Feedback

## 7-1. clearTimeout

ì‚¬ìš©ìê°€ `submit` ì„ ì—°ì†ì ìœ¼ë¡œ ìˆ˜í–‰í–ˆì„ ë•Œ, ê¸°ì¡´ì˜ timerë“¤ë„ ê°™ì´ ì¤‘ì²©ë˜ì–´ ì‹¤í–‰ë˜ë©°, ë·°ë¥¼ ê²¹ì³ì„œ ì—…ë°ì´íŠ¸í•˜ëŠ” ì˜¤ë¥˜ê°€ ìˆë‹¤. ì…ë ¥ ì´ë²¤íŠ¸ë¥¼ ì œí•œí•˜ê±°ë‚˜ timerë¥¼ ì¬ì„¤ì •í•´ì£¼ëŠ” ë“±ì˜ ì‘ì—…ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.
