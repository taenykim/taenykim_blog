---
title: ğŸ”® ì†Œë§ˆë²• í”„ë¡œì íŠ¸ -8 (maskmap)
date: 2020-03-18 17:03:86
category: project
draft: false
---

**ë„¤ì´ë²„ ì§€ë„ API**ì™€ **ê³µì  ë§ˆìŠ¤í¬ íŒë§¤ í˜„í™© ì¡°íšŒ API**ë¥¼ ì´ìš©í•´ì„œ ë§Œë“  ì½”ë¡œë‚˜ ë§ˆìŠ¤í¬ íŒë§¤ì²˜ ì°¾ê¸° ì–´í”Œë¦¬ì¼€ì´ì…˜

<hr/>

```toc
exclude: Table of Contents
from-heading: 1
to-heading: 5
```

# \#. Project Map

- :apple: <a href="https://small-magic-project.now.sh/" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸</a>

- :apple: <a href="https://small-magic-project.now.sh/maskmap" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸/maskmap</a>

* :fire: <a href="https://github.com/taenykim/small-magic-project" target="_blank">í”„ë¡œì íŠ¸ ê¹ƒí—ˆë¸Œì†ŒìŠ¤</a>

<br/>

<details>
<summary>ì œì‘ë…¸íŠ¸ í•œëˆˆì—ë³´ê¸°[ì ‘ê¸°/í¼ì¹˜ê¸°]</summary>
<div markdown="1">

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 1 (container)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B81/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 2 (calculator)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B82/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 3 (graph)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B83/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 4 (crawling)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B84/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 5 (today)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B85/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 6 (jjal)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B86/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 7 (avengers)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B87/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 8 (maskmap)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B88/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 9 (loading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B89/)

</div>
</details>

# 1. ë ˆì´ì•„ì›ƒ

## 1-1. ë©”ì¸í™”ë©´

![](./images/maskmap.png)

ì „ì²´ í™”ë©´í¬ê¸°ì— ë§ê²Œ ë„¤ì´ë²„ì§€ë„ë¡œ ì±„ìš°ê³ , í™”ë©´ ì¢Œì¸¡ì—

1. **ë‚´ ìœ„ì¹˜** ë²„íŠ¼

2. ë§ˆìŠ¤í¬ 5ë¶€ì œì— í•´ë‹¹í•˜ëŠ” ì˜¤ëŠ˜ ìš”ì¼ê³¼ ë§ˆìŠ¤í¬ êµ¬ì… ë…„ìƒ í‘œì‹œì°½

3. ë§ˆìŠ¤í¬ íŒë§¤ì²˜ì˜ ë§ˆìŠ¤í¬ ë³´ìœ ê°œìˆ˜ì— ëŒ€í•œ ìƒ‰ìƒ ì„¤ëª…ì°½ì„ ë‘ì—ˆë‹¤.

## 1-2. ì»´í¬ë„ŒíŠ¸

```jsx
<BackgroundContainer>
  <ContentsMenubar name="maskmap" />
  <Description>
    <button onClick={mylocationHandler}>ë‚´ ìœ„ì¹˜</button>
    <div>
      <span
        style={{
          textAlign: 'center',
          color: 'black',
          background: 'rgba(255,255,255,0.7)',
        }}
      >
        <div style={{ fontSize: '20px', fontFamily: 'escore8' }}>
          {weekArr[week]}ìš”ì¼
        </div>
        <div style={{ marginTop: '5px' }}>{weekMask[week]}</div>
      </span>
      <span style={{ background: 'green' }}>100ê°œì´ìƒ</span>
      <span style={{ background: 'orange' }}>30~100ê°œ</span>
      <span style={{ background: 'red' }}>2~30ê°œ</span>
      <span style={{ background: 'black' }}>ì—†ìŒ</span>
    </div>
  </Description>
  <MapContainer id="map"></MapContainer>
</BackgroundContainer>
```

ì»´í¬ë„ŒíŠ¸ëŠ” í¬ê²Œ

1. **Description** : í™”ë©´ ì¢Œì¸¡ ë‚´ìœ„ì¹˜ ë²„íŠ¼ê³¼ ì„¤ëª…ì°½

2. **MapContainer** : ì§€ë„

ë‘ ê°œë¡œ êµ¬ì„±í•˜ì˜€ê³  ë‘ ì»´í¬ë„ŒíŠ¸ ëª¨ë‘ `styled-component` ë¡œ êµ¬ì„±í•˜ì˜€ë‹¤.

# 2. ìƒíƒœê´€ë¦¬

```jsx
let map = null
const week = new Date().getDay()
const weekArr = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ']
const weekMask = [
  'ëˆ„êµ¬ë‚˜',
  '1,6ë…„ìƒ',
  '2,7ë…„ìƒ',
  '3,8ë…„ìƒ',
  '4,9ë…„ìƒ',
  '5,0ë…„ìƒ',
  'ëˆ„êµ¬ë‚˜',
]
```

> 1. `map` : ë„¤ì´ë²„ ì§€ë„ API **naver.maps.Map** ê°ì²´ê°€ ë‹´ê¸¸ ë³€ìˆ˜

> 2. `week` : í˜„ì¬ ìš”ì¼

> 3. `weekArr` : í˜„ì¬ ìš”ì¼ì— ëŒ€í•œ í•œê¸€ì¶œë ¥

> 4. `weekMask` : ìš”ì¼ì— ëŒ€í•œ ë§ˆìŠ¤í¬ 5ë¶€ì œ ì •ë³´

# 3. ë„¤ì´ë²„ì§€ë„ API

## 3-1. ì§€ë„ê°€ ë“¤ì–´ê°ˆ ì—˜ë¦¬ë¨¼íŠ¸ ì§€ì •

```jsx
<MapContainer id="map"></MapContainer>
```

ë¨¼ì € ì§€ë„ê°€ ë“¤ì–´ê°ˆ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì§€ì •í•˜ê³  id ê°’ì„ ë¶™ì—¬, DOMì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ì—ˆë‹¤.

## 3-2. ì§€ë„ ìƒì„±

```jsx
useEffect(() => {
    map = new naver.maps.Map('map', {
      center: new naver.maps.LatLng(37.5666805, 126.9784147),
      zoom: 10,
      mapTypeId: naver.maps.MapTypeId.NORMAL
    })
```

ì§€ë„ëŠ” ë§ˆìš´íŠ¸ëœ í›„ì— ì‹¤í–‰ë˜ëŠ” `useEffect` í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±í•´ì£¼ì—ˆë‹¤.

ê¸°ë³¸ì ì¸ ì •ë³´(ì§€ë„í˜„ì¬ìœ„ì¹˜, ì¤Œ, íƒ€ì…)ì€ ë„¤ì´ë²„ì§€ë„ì—ì„œ ì œê³µí•œ ê¸°ë³¸ì ì¸ ì •ë³´ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤. (ì„œìš¸ì‹œì²­)

## 3-3. ë‚´ ìœ„ì¹˜ ì°¾ê¸°

```jsx
<button onClick={mylocationHandler}>ë‚´ ìœ„ì¹˜</button>
```

ìš°ì„  button í´ë¦­ ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ì— mylocationHandler í•¨ìˆ˜ë¥¼ ë“±ë¡í•˜ê³ ,

```jsx
const onSuccessGeolocation = position => {
  var location = new naver.maps.LatLng(
    position.coords.latitude,
    position.coords.longitude
  )

  map.setCenter(location)
  map.setZoom(16)
}

const onErrorGeolocation = () => {
  // ì—ëŸ¬!!
}

const mylocationHandler = () => {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      onSuccessGeolocation,
      onErrorGeolocation
    )
  } else {
    // ì—ëŸ¬
  }
}
```

ìœ ì €ê°€ ìœ„ì¹˜ê¶Œí•œì„ í—ˆìš©í–ˆë‹¤ë©´ getCurrentPosition ë©”ì†Œë“œë¥¼ í†µí•˜ì—¬ í˜„ì¬ ìœ„ì¹˜ì •ë³´ë¥¼ map ê°ì²´ë³€ìˆ˜ì— ë„£ì–´ì£¼ì—ˆë‹¤.

# 4. ë§ˆìŠ¤í¬ íŒë§¤í˜„í™© API

## 4-1. addListener

```jsx
naver.maps.Event.addListener(map, 'dragend', function(e) {
  // ...
})
```

ë¨¼ì € API í†µì‹ ì€ ìœ ì €ê°€ ì§€ë„ë¥¼ ë“œë˜ê·¸í•  ë•Œë§ˆë‹¤ ìš”ì²­í•˜ê²Œë” êµ¬í˜„í•´ë³´ì•˜ëŠ”ë°

maps.Eventì˜ addListener ë©”ì†Œë“œ parameter ì•ˆì— í˜„ì¬ì§€ë„ `map`, `dragend` ì´ë²¤íŠ¸, `ì½œë°±í•¨ìˆ˜`ë¥¼ ë„£ì–´ì£¼ì—ˆë‹¤.

## 4-2. fetch (AJAX)

```jsx
const url =
  'https://8oi9s0nnth.apigw.ntruss.com/corona19-masks/v1/storesByGeo/json'
const query = `?lat=${map.getCenter().y}&lng=${map.getCenter().x}`
fetch(url + query)
  .then(res => {
    return res.json()
  })
  .then(json => {
    // ...
  })
```

API í†µì‹ ì€ fetchë¥¼ ì´ìš©í–ˆê³  then ë©”ì†Œë“œ ì²´ì´ë‹ì„ í†µí•´ ìš”ì²­ë°›ì€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•´ì£¼ì—ˆë‹¤.

ê·¸ë¦¬ê³  [ê³µì  ë§ˆìŠ¤í¬ íŒë§¤ í˜„í™© ì¡°íšŒ API](https://app.swaggerhub.com/apis-docs/Promptech/public-mask-info/20200307-oas3) ì— í•„ìš”í•œ parameterë‚˜ ì „ë‹¬ë°›ì„ JSON ë°ì´í„° í˜•ì‹ì´ ì˜ ë‚˜ì™€ìˆì–´ì„œ ì°¸ê³ í•˜ë©° urlì„ êµ¬ì„±í•˜ì˜€ë‹¤.

## 4-3. ë§ˆìŠ¤í¬íŒë§¤í˜„í™© marker

```jsx
const remain_stat = {
  plenty: 'green',
  some: 'orange',
  few: 'red',
  empty: 'black',
  break: 'black',
}
for (let i = 0; i < json.count; i++) {
  var marker = new naver.maps.Marker({
    icon: {
      content: `<div style="font-size:10px; font-family:escore6; border:1px solid lightgrey; color:white; background:${
        remain_stat[json.stores[i].remain_stat]
      }; border-radius:5px; padding:4px;">${json.stores[i].name}</div>`,
    },
    position: new naver.maps.LatLng(json.stores[i].lat, json.stores[i].lng),
    map: map,
  })
}
```

ë§ˆì§€ë§‰ìœ¼ë¡œ ë§ˆìŠ¤í¬íŒë§¤í•˜ëŠ” ê³³ì˜ íŒë§¤í˜„í™©ì„ í‘œì‹œí•˜ëŠ” ë§ˆì»¤ë¥¼ ë„£ì–´ì£¼ì—ˆëŠ”ë° [ê³µì  ë§ˆìŠ¤í¬ íŒë§¤ í˜„í™© ì¡°íšŒ API](https://app.swaggerhub.com/apis-docs/Promptech/public-mask-info/20200307-oas3) ì—ì„œëŠ” ë§ˆìŠ¤í¬ê°¯ìˆ˜ì— ë”°ë¥¸ ìƒ‰ê¹”ì„ í†µì¼í•´ì£¼ëŠ” ê²ƒì„ ê¶Œì¥í•˜ì—¬ì„œ ê·¸ì— ë§ê²Œ ìƒ‰ê¹”ì„ ì§€ì •í•´ì£¼ì—ˆë‹¤.

> ë…¹ìƒ‰(100ê°œ ì´ìƒ)/ë…¸ë‘ìƒ‰(30~99ê°œ)/ë¹¨ê°•ìƒ‰(2~29ê°œ)/íšŒìƒ‰(0~1ê°œ)

# 5. ê°œì¸ì ì¸ í”¼ë“œë°±

## 5-1. ë§ˆì»¤í‘œì‹œ ì´ë²¤íŠ¸

í•´ë‹¹ ì•±ì—ì„œ ì§€ë„ì— ë§ˆìŠ¤í¬ í˜„í™© ë§ˆì»¤ë¥¼ í‘œì‹œí•˜ë ¤ë©´ ìš°ì„  ì‚¬ìš©ìëŠ” ì§€ë„ë¥¼ ë“œë˜ê·¸í•´ì•¼í•œë‹¤.

`dragend` ì´ë²¤íŠ¸ë¼ ë“œë˜ê·¸ê°€ ì™„ë£Œëœ ì‹œì ì— í•œë²ˆë§Œ apië¥¼ í˜¸ì¶œí•œë‹¤ëŠ” ì ì—ì„œ íš¨ìœ¨ì ì´ì§€ë§Œ uxì ìœ¼ë¡œëŠ” ë³„ë¡œ ì¢‹ì§€ ëª»í•œ ê²ƒ ê°™ë‹¤.

ì´ˆê¸° ì§€ë„ êµ¬ì„±ì‹œ (í˜¹ì€, í˜„ì¬ìœ„ì¹˜ ë²„íŠ¼ì„ ì²˜ìŒ í´ë¦­í•œ ì‹œì )ì—ë„ ë§ˆì»¤ë¥¼ í‘œì‹œí•´ì£¼ëŠ” ê¸°ëŠ¥ì„ ë„£ìœ¼ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

## 5-2. ì§€ë„ì˜ ë¶€ì •í™•í•¨

ì´ê±°ëŠ” ì§€ë„ APIì˜ ë¬¸ì  ì§€ ë‚´ ì½”ë“œì˜ ë¬¸ì  ì§€ ì•„ì§ íŒŒì•…ì„ ëª»í–ˆì§€ë§Œ ë‚´ ìœ„ì¹˜ê°€ ì •í™•íˆ í‘œì‹œë˜ì§€ ì•ŠëŠ” ê²ƒ ê°™ë‹¤.

> ê·¸ë˜ë„ ë‚´ ìœ„ì¹˜ ê·¼ë°©ê¹Œì§€ëŠ” ì˜ í‘œì‹œí•´ì£¼ëŠ” ê²ƒ ê°™ì•„ì„œ ìœ ì €ê°€ í—·ê°ˆë¦¬ì§€ ì•Šê²Œ ê·¸ëƒ¥ë‚´ìœ„ì¹˜ ë§ˆì»¤ë¥¼ ë¹¼ë²„ë ¸ë‹¤!
