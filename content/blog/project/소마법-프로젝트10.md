---
title: ğŸ”® ì†Œë§ˆë²• í”„ë¡œì íŠ¸ -10 (lazyloading)
date: 2020-04-07 11:04:64
category: project
draft: false
---

í˜ì´ì§€ ë¡œë“œ ì‹œ, ì´ë¯¸ì§€ë‚˜ ë™ì˜ìƒ ê°™ì€ ìš©ëŸ‰ì´ í° ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ë¶ˆëŸ¬ì˜¤ëŠ” ê²Œ ì•„ë‹ˆë¼ ì‚¬ìš©ìì˜ ë·° ì˜ì—­ì— ë„ë‹¬ í–ˆì„ ë•Œ, í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•˜ëŠ” **ì§€ì—°ë¡œë”© (lazy loading)**ì„ ì´ìš©í•´ë³´ì•˜ë‹¤.

<hr/>

```toc
exclude: Table of Contents
from-heading: 1
to-heading: 5
```

# \#. Project Map

- :apple: <a href="https://small-magic-project.now.sh/" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸</a>

- :apple: <a href="https://small-magic-project.now.sh/lazyloading" target="_blank">í”„ë¡œì íŠ¸ ì‚¬ì´íŠ¸/lazyloading</a>

* :fire: <a href="https://github.com/taenykim/small-magic-project" target="_blank">í”„ë¡œì íŠ¸ ê¹ƒí—ˆë¸Œì†ŒìŠ¤</a>

<br/>

<details>
<summary>ì œì‘ë…¸íŠ¸ í•œëˆˆì—ë³´ê¸°[ì ‘ê¸°/í¼ì¹˜ê¸°]</summary>
<div markdown="1">

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 1 (container)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B81/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 2 (calculator)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B82/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 3 (graph)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B83/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 4 (crawling)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B84/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 5 (today)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B85/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 6 (jjal)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B86/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 7 (avengers)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B87/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 8 (maskmap)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B88/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 9 (loading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B89/)

- [ì†Œë§ˆë²• í”„ë¡œì íŠ¸ - 10 (lazyloading)](https://taeny.dev/project/%EC%86%8C%EB%A7%88%EB%B2%95-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B810/)

</div>
</details>

# 1. ë ˆì´ì•„ì›ƒ

## 1-1. ë©”ì¸í™”ë©´

![](./images/lazyloadingmain.png)

> ìš°ì—°íˆ ì›ë³¸ ì´ë¯¸ì§€ì™€ blurëœ ì´ë¯¸ì§€ ëª¨ë‘ ì°í˜”ë‹¤...!

## 1-2. ì»´í¬ë„ŒíŠ¸

```js
<Contents style={{ marginTop: '100px' }}>
  <p>1ì´ˆì˜ ì§€ì—°ë¡œë”©(lazy loading) êµ¬í˜„</p>
  <div>íë¦° ì´ë¯¸ì§€ë¡œ ì§€ì—°</div>
  {obj.map(item => {
    return item
  })}
  <div>ë‹¨ìƒ‰ ì´ë¯¸ì§€ë¡œ ì§€ì—°</div>
  {obj2.map(item => {
    return item
  })}
</Contents>
```

Contents ë¼ëŠ” styled-componentë¥¼ ì‚¬ìš©í•´ì„œ, Container ë¿ë§Œ ì•„ë‹ˆë¼ ë‚´ë¶€ pë‚˜ divì˜ ìŠ¤íƒ€ì¼ë„ ì¡°ì •í•´ì£¼ì—ˆë‹¤.

# 2. ì§€ì—°ë¡œë”©

### 2-1. :star: src, data-src

```jsx
<img className="lazy" src="ë¡œë”©ì „ì´ë¯¸ì§€URL" data-src="URL" alt="Some tacos." />
```

`data-src` ì†ì„± ê°’ì—ëŠ” ì›ë³¸ ì´ë¯¸ì§€ URLì„ ë„£ê³ , `src` ì†ì„± ê°’ì—ëŠ” ë¹„êµì  ìš©ëŸ‰ì´ ë‚®ì€ ëŒ€ì²´ ì´ë¯¸ì§€ URLì„ ë„£ì–´ì¤€ë‹¤.

### 2-2. :star: nodeList -> Array

```js
let lazyImages = [].slice.call(document.querySelectorAll('img.lazy'))
// or
let lazyImages = Array.slice.call(document.querySelectorAll('img.lazy'))
```

`querySelectorAll` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ DOM ì—˜ë¦¬ë¨¼íŠ¸ë“¤ì´ ë°°ì—´í˜•íƒœê°€ ì•„ë‹ˆë¼ ë…¸ë“œë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë¶ˆëŸ¬ì™€ì§„ë‹¤.

ê·¸ë˜ì„œ ë°°ì—´ì˜ í˜•íƒœë¡œ ë³€í™˜í•´ì£¼ì–´ì•¼í•¨.

ë°°ì—´ ë©”ì†Œë“œì˜ `slice`ë¥¼ ì‚¬ìš©í•˜ê³  `call()`ì„ í†µí•´ ë°”ì¸ë”© í•´ì£¼ë©´ ë¨.

### 2-3. scroll ì´ë²¤íŠ¸

```js
const lazyLoad = () => {
  if (active === false) {
    active = true

    setTimeout(() => {
      // image lazy loading ë¶€ë¶„
      // ...

      active = false
    }, 1000)
  }
}

document.addEventListener('scroll', lazyLoad)
```

ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡í•˜ê³ , ë‚´ë¶€ì— image lazy loading ì½”ë“œë¥¼ ë„£ì–´ì£¼ì—ˆëŠ”ë°,

lazy loadingì´ ì§ê´€ì ìœ¼ë¡œ ë³´ì´ì§€ ì•Šì•„ì„œ setTimeout() í•¨ìˆ˜ë¡œ 1ì´ˆê°„ ê°•ì œë¡œ ì§€ì—°ì‹œì¼œì£¼ì—ˆë‹¤. ğŸ˜‚

### 2-4. :star: ì§€ì—°ë¡œë”© : getBoundingClientRect()

```js
lazyImages.map(lazyImage => {
  if (
    lazyImage.getBoundingClientRect().top <= window.innerHeight &&
    lazyImage.getBoundingClientRect().bottom >= 0 &&
    getComputedStyle(lazyImage).display !== 'none'
  ) {
    lazyImage.src = lazyImage.dataset.src
    lazyImage.classList.remove('lazy')

    lazyImages = lazyImages.filter(function(image) {
      return image !== lazyImage
    })

    if (lazyImages.length === 0) {
      document.removeEventListener('scroll', lazyLoad)
    }
  }
})
```

ë¨¼ì € `getBoundingClientRect()`ë¥¼ í†µí•˜ì—¬ ì´ë¯¸ì§€ì˜ í¬ê¸°ìš”ì†Œë¥¼ êµ¬í•˜ê³ , ì¡°ê±´ë¬¸ì„ í†µí•´ ìŠ¤í¬ë¦°ì— ë“±ì¥í•  ë•Œ ë‹¤ìŒ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•´ì£¼ì—ˆë‹¤.

![](./images/getRec.png)

> `getComputedStyle()` ëŠ” DOM elementì˜ style ì†ì„±ê³¼ ì†ì„±ê°’ì„ ê°ì²´ í˜•íƒœë¡œ ê°€ì ¸ì˜¤ëŠ” window ë‚´ë¶€ ë©”ì†Œë“œì´ë‹¤.

ê·¸ë¦¬ê³  ì¡°ê±´ë¬¸ì„ í†µê³¼í•˜ë©´ srcê°’ì„ ë°”ê¾¸ë„ë¡ í•˜ì˜€ë‹¤.

**ê·¸ë¦¬ê³  ë°ì´í„°ë¥¼ ì½ì–´ì˜¤ë©´ classë¥¼ ì‚­ì œí•˜ê³  ë°°ì—´ì„ ë¹„ì› ê³ , ëª¨ë“  ë°°ì—´ì´ ë¹„ì›Œì§€ë©´ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ë¥¼ ì‚­ì œí•˜ëŠ” ë“± ìµœì í™” ì‘ì—…ë„ í•´ì£¼ì—ˆë‹¤.**

# 3. ê°œì¸ì ì¸ í”¼ë“œë°±

### 3-1. Chrome Native lazy loading

```js
<img src="cat.jpg" loading="lazy" />
```

> ì´ëŸ° ë°©ì‹ë„ ì“¸ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤..!

# 4. ì°¸ê³ 

- [Lazy Loading Example(codepen.io) By Jeremy Wagner](https://codepen.io/malchata/pen/mXoZGx)

- [ì´ë¯¸ì§€ ë° ë™ì˜ìƒì˜ ì§€ì—° ë¡œë”© By Jeremy Wagner](https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video?hl=ko#%EC%9D%B4%EB%AF%B8%EC%A7%80_%EC%A7%80%EC%97%B0_%EB%A1%9C%EB%94%A9)
